package src_code;

import java.util.HashMap;

public class ScoringMatrix {

	// All possible name of aminoacids
	static private final String allAANames = "ARNDCQEGHILKMFPSTWYVBJZX-";

	// font: http://www.ncbi.nlm.nih.gov/Class/FieldGuide/BLOSUM62.txt
	static public final int[][] BLOSUM62 = {
			{ 4, -1, -2, -2, 0, -1, -1, 0, -2, -1, -1, -1, -1, -2, -1, 1, 0,
					-3, -2, 0, -2, -1, 0, -4 },
			{ -1, 5, 0, -2, -3, 1, 0, -2, 0, -3, -2, 2, -1, -3, -2, -1, -1, -3,
					-2, -3, -1, 0, -1, -4 },
			{ -2, 0, 6, 1, -3, 0, 0, 0, 1, -3, -3, 0, -2, -3, -2, 1, 0, -4, -2,
					-3, 3, 0, -1, -4 },
			{ -2, -2, 1, 6, -3, 0, 2, -1, -1, -3, -4, -1, -3, -3, -1, 0, -1,
					-4, -3, -3, 4, 1, -1, -4 },
			{ 0, -3, -3, -3, 9, -3, -4, -3, -3, -1, -1, -3, -1, -2, -3, -1, -1,
					-2, -2, -1, -3, -3, -2, -4 },
			{ -1, 1, 0, 0, -3, 5, 2, -2, 0, -3, -2, 1, 0, -3, -1, 0, -1, -2,
					-1, -2, 0, 3, -1, -4 },
			{ -1, 0, 0, 2, -4, 2, 5, -2, 0, -3, -3, 1, -2, -3, -1, 0, -1, -3,
					-2, -2, 1, 4, -1, -4 },
			{ 0, -2, 0, -1, -3, -2, -2, 6, -2, -4, -4, -2, -3, -3, -2, 0, -2,
					-2, -3, -3, -1, -2, -1, -4 },
			{ -2, 0, 1, -1, -3, 0, 0, -2, 8, -3, -3, -1, -2, -1, -2, -1, -2,
					-2, 2, -3, 0, 0, -1, -4 },
			{ -1, -3, -3, -3, -1, -3, -3, -4, -3, 4, 2, -3, 1, 0, -3, -2, -1,
					-3, -1, 3, -3, -3, -1, -4 },
			{ -1, -2, -3, -4, -1, -2, -3, -4, -3, 2, 4, -2, 2, 0, -3, -2, -1,
					-2, -1, 1, -4, -3, -1, -4 },
			{ -1, 2, 0, -1, -3, 1, 1, -2, -1, -3, -2, 5, -1, -3, -1, 0, -1, -3,
					-2, -2, 0, 1, -1, -4 },
			{ -1, -1, -2, -3, -1, 0, -2, -3, -2, 1, 2, -1, 5, 0, -2, -1, -1,
					-1, -1, 1, -3, -1, -1, -4 },
			{ -2, -3, -3, -3, -2, -3, -3, -3, -1, 0, 0, -3, 0, 6, -4, -2, -2,
					1, 3, -1, -3, -3, -1, -4 },
			{ -1, -2, -2, -1, -3, -1, -1, -2, -2, -3, -3, -1, -2, -4, 7, -1,
					-1, -4, -3, -2, -2, -1, -2, -4 },
			{ 1, -1, 1, 0, -1, 0, 0, 0, -1, -2, -2, 0, -1, -2, -1, 4, 1, -3,
					-2, -2, 0, 0, 0, -4 },
			{ 0, -1, 0, -1, -1, -1, -1, -2, -2, -1, -1, -1, -1, -2, -1, 1, 5,
					-2, -2, 0, -1, -1, 0, -4 },
			{ -3, -3, -4, -4, -2, -2, -3, -2, -2, -3, -2, -3, -1, 1, -4, -3,
					-2, 11, 2, -3, -4, -3, -2, -4 },
			{ -2, -2, -2, -3, -2, -1, -2, -3, 2, -1, -1, -2, -1, 3, -3, -2, -2,
					2, 7, -1, -3, -2, -1, -4 },
			{ 0, -3, -3, -3, -1, -2, -2, -3, -3, 3, 1, -2, 1, -1, -2, -2, 0,
					-3, -1, 4, -3, -2, -1, -4 },
			{ -2, -1, 3, 4, -3, 0, 1, -1, 0, -3, -4, 0, -3, -3, -2, 0, -1, -4,
					-3, -3, 4, 1, -1, -4 },
			{ -1, 0, 0, 1, -3, 3, 4, -2, 0, -3, -3, 1, -1, -3, -1, 0, -1, -3,
					-2, -2, 1, 4, -1, -4 },
			{ 0, -1, -1, -1, -2, -1, -1, -1, -1, -1, -1, -1, -1, -1, -2, 0, 0,
					-2, -1, -1, -1, -1, -1, -4 },
			{ -4, -4, -4, -4, -4, -4, -4, -4, -4, -4, -4, -4, -4, -4, -4, -4,
					-4, -4, -4, -4, -4, -4, -4, 1, } };

	// http://www.ncbi.nlm.nih.gov/IEB/ToolBox/C_DOC/lxr/source/data/BLOSUM50
	static public final int[][] BLOSUM50 = {
			{ 5, -2, -1, -2, -1, -1, -1, 0, -2, -1, -2, -1, -1, -3, -1, 1, 0,
					-3, -2, 0, -2, -2, -1, -1, -5 },
			{ -2, 7, -1, -2, -4, 1, 0, -3, 0, -4, -3, 3, -2, -3, -3, -1, -1,
					-3, -1, -3, -1, -3, 0, -1, -5 },
			{ -1, -1, 7, 2, -2, 0, 0, 0, 1, -3, -4, 0, -2, -4, -2, 1, 0, -4,
					-2, -3, 5, -4, 0, -1, -5 },
			{ -2, -2, 2, 8, -4, 0, 2, -1, -1, -4, -4, -1, -4, -5, -1, 0, -1,
					-5, -3, -4, 6, -4, 1, -1, -5 },
			{ -1, -4, -2, -4, 13, -3, -3, -3, -3, -2, -2, -3, -2, -2, -4, -1,
					-1, -5, -3, -1, -3, -2, -3, -1, -5 },
			{ -1, 1, 0, 0, -3, 7, 2, -2, 1, -3, -2, 2, 0, -4, -1, 0, -1, -1,
					-1, -3, 0, -3, 4, -1, -5 },
			{ -1, 0, 0, 2, -3, 2, 6, -3, 0, -4, -3, 1, -2, -3, -1, -1, -1, -3,
					-2, -3, 1, -3, 5, -1, -5 },
			{ 0, -3, 0, -1, -3, -2, -3, 8, -2, -4, -4, -2, -3, -4, -2, 0, -2,
					-3, -3, -4, -1, -4, -2, -1, -5 },
			{ -2, 0, 1, -1, -3, 1, 0, -2, 10, -4, -3, 0, -1, -1, -2, -1, -2,
					-3, 2, -4, 0, -3, 0, -1, -5 },
			{ -1, -4, -3, -4, -2, -3, -4, -4, -4, 5, 2, -3, 2, 0, -3, -3, -1,
					-3, -1, 4, -4, 4, -3, -1, -5 },
			{ -2, -3, -4, -4, -2, -2, -3, -4, -3, 2, 5, -3, 3, 1, -4, -3, -1,
					-2, -1, 1, -4, 4, -3, -1, -5 },
			{ -1, 3, 0, -1, -3, 2, 1, -2, 0, -3, -3, 6, -2, -4, -1, 0, -1, -3,
					-2, -3, 0, -3, 1, -1, -5 },
			{ -1, -2, -2, -4, -2, 0, -2, -3, -1, 2, 3, -2, 7, 0, -3, -2, -1,
					-1, 0, 1, -3, 2, -1, -1, -5 },
			{ -3, -3, -4, -5, -2, -4, -3, -4, -1, 0, 1, -4, 0, 8, -4, -3, -2,
					1, 4, -1, -4, 1, -4, -1, -5 },
			{ -1, -3, -2, -1, -4, -1, -1, -2, -2, -3, -4, -1, -3, -4, 10, -1,
					-1, -4, -3, -3, -2, -3, -1, -1, -5 },
			{ 1, -1, 1, 0, -1, 0, -1, 0, -1, -3, -3, 0, -2, -3, -1, 5, 2, -4,
					-2, -2, 0, -3, 0, -1, -5 },
			{ 0, -1, 0, -1, -1, -1, -1, -2, -2, -1, -1, -1, -1, -2, -1, 2, 5,
					-3, -2, 0, 0, -1, -1, -1, -5 },
			{ -3, -3, -4, -5, -5, -1, -3, -3, -3, -3, -2, -3, -1, 1, -4, -4,
					-3, 15, 2, -3, -5, -2, -2, -1, -5 },
			{ -2, -1, -2, -3, -3, -1, -2, -3, 2, -1, -1, -2, 0, 4, -3, -2, -2,
					2, 8, -1, -3, -1, -2, -1, -5 },
			{ 0, -3, -3, -4, -1, -3, -3, -4, -4, 4, 1, -3, 1, -1, -3, -2, 0,
					-3, -1, 5, -3, 2, -3, -1, -5 },
			{ -2, -1, 5, 6, -3, 0, 1, -1, 0, -4, -4, 0, -3, -4, -2, 0, 0, -5,
					-3, -3, 6, -4, 1, -1, -5 },
			{ -2, -3, -4, -4, -2, -3, -3, -4, -3, 4, 4, -3, 2, 1, -3, -3, -1,
					-2, -1, 2, -4, 4, -3, -1, -5 },
			{ -1, 0, 0, 1, -3, 4, 5, -2, 0, -3, -3, 1, -1, -4, -1, 0, -1, -2,
					-2, -3, 1, -3, 5, -1, -5 },
			{ -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
					-1, -1, -1, -1, -1, -1, -1, -1, -5 },
			{ -5, -5, -5, -5, -5, -5, -5, -5, -5, -5, -5, -5, -5, -5, -5, -5,
					-5, -5, -5, -5, -5, -5, -5, -5, 1 } };

	// http://www.ncbi.nlm.nih.gov/IEB/ToolBox/C_DOC/lxr/source/data/PAM70
	static public final int[][] PAM70 = {
			{ 5, -4, -2, -1, -4, -2, -1, 0, -4, -2, -4, -4, -3, -6, 0, 1, 1,
					-9, -5, -1, -1, -3, -1, -1, -11 },
			{ -4, 8, -3, -6, -5, 0, -5, -6, 0, -3, -6, 2, -2, -7, -2, -1, -4,
					0, -7, -5, -4, -5, -2, -1, -11 },
			{ -2, -3, 6, 3, -7, -1, 0, -1, 1, -3, -5, 0, -5, -6, -3, 1, 0, -6,
					-3, -5, 5, -4, -1, -1, -11 },
			{ -1, -6, 3, 6, -9, 0, 3, -1, -1, -5, -8, -2, -7, -10, -4, -1, -2,
					-10, -7, -5, 5, -7, 2, -1, -11 },
			{ -4, -5, -7, -9, 9, -9, -9, -6, -5, -4, -10, -9, -9, -8, -5, -1,
					-5, -11, -2, -4, -8, -7, -9, -1, -11 },
			{ -2, 0, -1, 0, -9, 7, 2, -4, 2, -5, -3, -1, -2, -9, -1, -3, -3,
					-8, -8, -4, -1, -3, 5, -1, -11 },
			{ -1, -5, 0, 3, -9, 2, 6, -2, -2, -4, -6, -2, -4, -9, -3, -2, -3,
					-11, -6, -4, 2, -5, 5, -1, -11 },
			{ 0, -6, -1, -1, -6, -4, -2, 6, -6, -6, -7, -5, -6, -7, -3, 0, -3,
					-10, -9, -3, -1, -7, -3, -1, -11 },
			{ -4, 0, 1, -1, -5, 2, -2, -6, 8, -6, -4, -3, -6, -4, -2, -3, -4,
					-5, -1, -4, 0, -4, 1, -1, -11 },
			{ -2, -3, -3, -5, -4, -5, -4, -6, -6, 7, 1, -4, 1, 0, -5, -4, -1,
					-9, -4, 3, -4, 4, -4, -1, -11 },
			{ -4, -6, -5, -8, -10, -3, -6, -7, -4, 1, 6, -5, 2, -1, -5, -6, -4,
					-4, -4, 0, -6, 5, -4, -1, -11 },
			{ -4, 2, 0, -2, -9, -1, -2, -5, -3, -4, -5, 6, 0, -9, -4, -2, -1,
					-7, -7, -6, -1, -5, -2, -1, -11 },
			{ -3, -2, -5, -7, -9, -2, -4, -6, -6, 1, 2, 0, 10, -2, -5, -3, -2,
					-8, -7, 0, -6, 2, -3, -1, -11 },
			{ -6, -7, -6, -10, -8, -9, -9, -7, -4, 0, -1, -9, -2, 8, -7, -4,
					-6, -2, 4, -5, -7, -1, -9, -1, -11 },
			{ 0, -2, -3, -4, -5, -1, -3, -3, -2, -5, -5, -4, -5, -7, 7, 0, -2,
					-9, -9, -3, -4, -5, -2, -1, -11 },
			{ 1, -1, 1, -1, -1, -3, -2, 0, -3, -4, -6, -2, -3, -4, 0, 5, 2, -3,
					-5, -3, 0, -5, -2, -1, -11 },
			{ 1, -4, 0, -2, -5, -3, -3, -3, -4, -1, -4, -1, -2, -6, -2, 2, 6,
					-8, -4, -1, -1, -3, -3, -1, -11 },
			{ -9, 0, -6, -10, -11, -8, -11, -10, -5, -9, -4, -7, -8, -2, -9,
					-3, -8, 13, -3, -10, -7, -5, -10, -1, -11 },
			{ -5, -7, -3, -7, -2, -8, -6, -9, -1, -4, -4, -7, -7, 4, -9, -5,
					-4, -3, 9, -5, -4, -4, -7, -1, -11 },
			{ -1, -5, -5, -5, -4, -4, -4, -3, -4, 3, 0, -6, 0, -5, -3, -3, -1,
					-10, -5, 6, -5, 1, -4, -1, -11 },
			{ -1, -4, 5, 5, -8, -1, 2, -1, 0, -4, -6, -1, -6, -7, -4, 0, -1,
					-7, -4, -5, 5, -5, 1, -1, -11 },
			{ -3, -5, -4, -7, -7, -3, -5, -7, -4, 4, 5, -5, 2, -1, -5, -5, -3,
					-5, -4, 1, -5, 5, -4, -1, -11 },
			{ -1, -2, -1, 2, -9, 5, 5, -3, 1, -4, -4, -2, -3, -9, -2, -2, -3,
					-10, -7, -4, 1, -4, 5, -1, -11 },
			{ -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
					-1, -1, -1, -1, -1, -1, -1, -1, -11 },
			{ -11, -11, -11, -11, -11, -11, -11, -11, -11, -11, -11, -11, -11,
					-11, -11, -11, -11, -11, -11, -11, -11, -11, -11, -11, 1 } };
	
	// Build a hashmap with the score of all pairs
	private HashMap<String, Integer> pair = new HashMap<String, Integer>(); 
	
	public ScoringMatrix(int[][] scoringMatrix) {
		try {
			this.pair = loadPairScore(scoringMatrix);
		} catch (Exception e) {
			System.err.println("Wrong matrix");
			e.printStackTrace();
		}
	}
	
	private static HashMap<String, Integer> loadPairScore(int fromMatrix[][]) {

		HashMap<String, Integer> allPairs = new HashMap<String, Integer>();

		String aux = allAANames;
		String aux2 = aux;

		/*
		 * Store all possible pairs between aux and aux2 in a hashmap, the value
		 * will be the score in the matrix.
		 */
		for (int i = 0; i < aux.length(); i++) {
			for (int j = 0; j < aux.length(); j++) {
				allPairs.put(
						Character.toString(aux.charAt(i))
								+ Character.toString(aux2.charAt(j)),
						fromMatrix[i][j]);
			}
		}

		return allPairs;
	}

	public int getScoreValueFromPair(Character el1, Character el2) {
		
		/*
		 * First, transform both characters into Upper case characters, and then,
		 * search for their match in the hash map.
		 */
		return pair.get(Character.toString(Character.toUpperCase(el1))
				+ Character.toString(Character.toUpperCase(el2)));
	}
}
